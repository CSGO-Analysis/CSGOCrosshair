// full javascript at javascript/javascript.js
function isCrosshairDynamic(e){return e==0||e==3}function getCrosshairStyleType(e){return e==0||e==1?"default":"classic"}function getCrosshairValue(e,t){var n=function(e,t,n){return e>=t&&e<=n?e:e<t?t:n};switch(e){case"color":t=n(t,1,5);break;case"style":t=n(t,0,4);break;case"alpha":case"color_r":case"color_g":case"color_b":t=n(t,0,255);break;case"dot":case"usealpha":t=n(t,0,1);break;case"thickness":case"size":t=t>=0?t:0;break;case"gap":t=t>=-100&&t<=100?t:TEMPLATE.def[e];break}return t}function getCrosshairParsed(e){var t,n,r=e,i={},s;for(type in CONFIG){i[type]=null;t=new RegExp(CONFIG[type]+'\\s\\"?([\\-\\d.]+)\\"?\\;?');n=r.match(t);if(n!=null){s=getCrosshairValue(type,parseFloat(n[1]));i[type]=s}}return i}function getBind(e){var t=String.fromCharCode(e);var n=e>=48&&e<=57||e>=65&&e<=90;if(!n){t="";switch(e){case 1:t="mouse1";break;case 2:t="mouse3";break;case 3:t="mouse2";break;case 8:t="backspace";break;case 13:t="enter";break;case 16:t="shift";break;case 17:t="ctrl";break;case 18:t="alt";break;case 19:t="pause";break;case 20:t="capslock";break;case 27:t="escape";break;case 32:t="space";break;case 33:t="pgup";break;case 34:t="pgdn";break;case 35:t="end";break;case 36:t="home";break;case 37:t="leftarrow";break;case 38:t="uparrow";break;case 39:t="rightarrow";break;case 40:t="downarrow";break;case 45:t="ins";break;case 46:t="del";break;case 59:t="semicolon";break;case 61:t="=";break;case 96:t="KP_INS";break;case 97:t="KP_END";break;case 98:t="KP_DOWNARROW";break;case 99:t="KP_PGDN";break;case 100:t="KP_LEFTARROW";break;case 101:t="KP_5";break;case 102:t="KP_RIGHTARROW";break;case 103:t="KP_HOME";break;case 104:t="KP_UPARROW";break;case 105:t="KP_PGUP";break;case 106:t="KP_MULTIPLY";break;case 107:t="KP_PLUS";break;case 109:t="KP_MINUS";break;case 110:t="KP_DEL";break;case 111:t="KP_SLASH";break;case 173:t="-";break;case 188:t=",";break;case 190:t=".";break;case 191:t="/";break;case 192:t="`";break;case 220:t="\\";break;case 219:t="[";break;case 221:t="]";break;case 222:t="'";break}if(e>=112&&e<=123){var r=e-111;t="F"+r}}return t.toUpperCase()}function getBindTypeTitle(e){switch(e){case"toggle":return"Toggle Crosshairs";case"toggle_dot":return"Toggle Dot";case"size_inc":return"Size Inc";case"size_dec":return"Size Dec";case"thickness_inc":return"Thickness Inc";case"thickness_dec":return"Thickness Dec";case"gap_inc":return"Gap Inc";case"gap_dec":return"Gap Dec"}return""}function getCrosshairConfig(e,t,n){t=t||"\n";n=n==undefined?'"':n;var r,i="";for(type in CONFIG){r=CONFIG[type]+" "+n+e[type]+n;i+=r+t}return jQuery.trim(i)}function componentToHex(e){var t=e.toString(16);return t.length==1?"0"+t:t}function rgbToHex(e,t,n){return"#"+componentToHex(e)+componentToHex(t)+componentToHex(n)}function round5(e){return e%5>=2.5?parseInt(e/5)*5+5:parseInt(e/5)*5}function bound(e,t,n){return e<t?n:e>n?t:e}function loadBackground(e){background=e;for(i in canvas.backgrounds){canvas.backgrounds[i].hide()}if(!backgrounds[e])return canvas.stage.draw();if(canvas.backgrounds[e]){canvas.backgrounds[e].show();canvas.backgrounds[e].centerBackground();canvas.stage.draw()}else{var t=new Image;t.onload=function(){canvas.backgrounds[e]=new Kinetic.Image({x:0,y:0,image:t,width:t.width,height:t.height});canvas.backgrounds[e].centerBackground=function(){this.setPosition((this.getWidth()-this.getStage().getWidth())/2*-1,(this.getHeight()-this.getStage().getHeight())/2*-1)};canvas.backgroundGroup.add(canvas.backgrounds[e]);canvas.backgrounds[e].centerBackground();canvas.stage.draw()};t.src=IMG_PATH+backgrounds[e]}}function createCrosshair(e,t,n){var r={group:null,classic:{group:null,left:null,right:null,top:null,bottom:null,dot:null},def:{group:null,left:null,right:null,top:null,bottom:null,dot:null,lines:{left:null,right:null,top:null,bottom:null}}};r.group=new Kinetic.Group({position:{x:n.x,y:n.y}});e.add(r.group);r.group.moveToTop();r.classic.group=new Kinetic.Group;r.group.add(r.classic.group);if(getCrosshairStyleType(t.style)=="classic")r.classic.group.show();else r.classic.group.hide();var i=new Kinetic.Rect({});r.classic.left=i.clone();r.classic.right=i.clone();r.classic.top=i.clone();r.classic.bottom=i.clone();r.classic.dot=new Kinetic.Rect({});r.classic.group.add(r.classic.left);r.classic.group.add(r.classic.right);r.classic.group.add(r.classic.top);r.classic.group.add(r.classic.bottom);r.classic.group.add(r.classic.dot);r.def.group=new Kinetic.Group;r.group.add(r.def.group);if(getCrosshairStyleType(t.style)=="default")r.def.group.show();else r.def.group.hide();var s=new Kinetic.Rect({});r.def.left=new Kinetic.Polygon({points:[0,0,-15,-2,-15,2],offset:[10,0],fill:"black"});r.def.right=r.def.left.clone();r.def.top=r.def.left.clone();r.def.bottom=r.def.left.clone();r.def.dot=new Kinetic.Circle({x:0,y:0,radius:2,shadow:{color:"black",blur:3,offset:[0,0],opacity:1}});r.def.lines.left=s.clone();r.def.lines.right=s.clone();r.def.lines.top=s.clone();r.def.lines.bottom=s.clone();r.def.group.add(r.def.left);r.def.group.add(r.def.right);r.def.group.add(r.def.top);r.def.group.add(r.def.bottom);r.def.group.add(r.def.dot);r.def.group.add(r.def.lines.left);r.def.group.add(r.def.lines.right);r.def.group.add(r.def.lines.top);r.def.group.add(r.def.lines.bottom);return r}function createControlSpinner(e,t,n,r){t=t||100;n=n||0;r=r||1;control.spinner[e]=$("#crosshair_"+e+"_spinner").val(crosshair[e]).spinner({min:n,max:t,step:r,value:crosshair[e],spin:function(t,n){var r={};r[e]=n.value;changeCrosshair(r)}}).keyup(function(){var t={};t[e]=$(this).spinner("value");changeCrosshair(t)})}function createControlSlider(e,t,n,r){t=t||100;n=n||0;r=r||1;control.slider[e]=$("#crosshair_"+e+"_slider").slider({min:n,max:t,step:r,value:crosshair[e],slide:function(t,n){var r={};r[e]=n.value;changeCrosshair(r)}})}function calcThickness(e){return e/10*THICKNESS_FACTOR}function calcLength(e){return e/10*LENGTH_FACTOR}function calcGap(e,t){return e*GAP_FACTOR+GAP_PAD+(!t?animate.step/10*ANIMATE_GAP:0)}function updateCrosshair(e,t,n){var r=rgbToHex(t.color_r,t.color_g,t.color_b);if(t.color>=1&&t.color<=4)r=COLOR.classic[t.color];var i=calcLength(t.size);var s=calcThickness(t.thickness);var o=calcGap(t.gap,n);e.classic.top.setSize(s,i*-1);e.classic.top.setFill(r);e.classic.top.setOffset(s/2,s/2+o);e.classic.left.setAttrs(e.classic.top.getAttrs());e.classic.left.rotateDeg(-90);e.classic.right.setAttrs(e.classic.top.getAttrs());e.classic.right.rotateDeg(90);e.classic.bottom.setAttrs(e.classic.top.getAttrs());e.classic.bottom.rotateDeg(180);e.classic.dot.setPosition(calcThickness(t.thickness)/2*-1,calcThickness(t.thickness)/2*-1);e.classic.dot.setFill(r);e.classic.dot.setSize(calcThickness(t.thickness),calcThickness(t.thickness));if(t.dot)e.classic.dot.show();else e.classic.dot.hide();e.classic.group.setOpacity(t.usealpha?t.alpha/ALPHA_FACTOR:.7);e.classic.size=i+e.classic.top.getOffset().y;var s=calcThickness(1);var o=isCrosshairDynamic(t.style)?calcGap(5,n):t.gap;var i=12;var u=s;var a=10;var f=t.color>=1&&t.color<=4?t.color:1;var l=isCrosshairDynamic(t.style);e.def.left.setPoints([0,0,i*-1,u*-1,i*-1,u]);e.def.left.setFill({start:{x:0,y:0},end:{x:i*-1,y:0},colorStops:COLOR.def[f].cross});e.def.left.setOffset(o,0);e.def.right.setAttrs(e.def.left.getAttrs());e.def.right.rotateDeg(180);e.def.top.setAttrs(e.def.left.getAttrs());e.def.top.rotateDeg(90);e.def.bottom.setAttrs(e.def.left.getAttrs());e.def.bottom.rotateDeg(-90);e.def.dot.setFill(COLOR.def[f].dot);e.def.lines.top.setPosition(0,0);e.def.lines.top.setFill(COLOR.def[f].line);e.def.lines.top.setSize(a,1);e.def.lines.top.setOpacity(.5);e.def.lines.top.setOffset(a/2,o);e.def.lines.top.show();e.def.lines.bottom.setAttrs(e.def.lines.top.getAttrs());e.def.lines.bottom.rotateDeg(180);e.def.lines.left.setAttrs(e.def.lines.top.getAttrs());e.def.lines.left.rotateDeg(-90);e.def.lines.right.setAttrs(e.def.lines.top.getAttrs());e.def.lines.right.rotateDeg(90);e.def.size=i+e.def.left.getOffset().x;if(getCrosshairStyleType(t.style)=="default"){e.def.group.show();e.classic.group.hide();if(!l){e.def.lines.top.hide();e.def.lines.bottom.hide();e.def.lines.left.hide();e.def.lines.right.hide()}}else{e.def.group.hide();e.classic.group.show()}e.def.group.getStage().draw()}function updateControl(){var e=getCrosshairStyleType(crosshair.style)=="classic";for(type in crosshair){if(control.spinner[type]){control.spinner[type].spinner("value",crosshair[type]);control.spinner[type].spinner(e||type=="gap"&&!isCrosshairDynamic(crosshair.style)?"enable":"disable")}if(control.slider[type]){control.slider[type].slider("value",crosshair[type]);control.slider[type].slider(e||type=="gap"&&!isCrosshairDynamic(crosshair.style)?"enable":"disable")}if(control.button[type]){control.button[type].button(e||type=="style"?"enable":"disable");var t=type!="style"&&crosshair[type]||type=="style"&&isCrosshairDynamic(crosshair[type]);control.button[type].prop("checked",t);control.button[type].val(crosshair[type]).button("refresh")}if(control.buttonset[type]){control.buttonset[type].find("input[value="+crosshair[type]+"]").prop("checked",false);control.buttonset[type].find("label").removeClass("ui-state-active").attr("aria-pressed",true);control.buttonset[type].buttonset(e||type=="style"||type=="color"?"enable":"disable");if(type=="style"){control.buttonset[type].find("input[value="+getCrosshairStyleType(crosshair[type])+"]").prop("checked",true);control.buttonset[type].find("label[for=crosshair_"+type+"_"+getCrosshairStyleType(crosshair[type])+"]").addClass("ui-state-active").attr("aria-pressed",true)}else{control.buttonset[type].find("input[value="+crosshair[type]+"]").prop("checked",true);control.buttonset[type].find("label[for=crosshair_"+type+"_"+crosshair[type]+"]").addClass("ui-state-active").attr("aria-pressed",true)}}}var n=e&&crosshair.usealpha;control.slider.alpha.slider(n?"enable":"disable");control.spinner.alpha.spinner(n?"enable":"disable");control.colorPalette.spectrum("set","rgb "+crosshair.color_r+" "+crosshair.color_g+" "+crosshair.color_b);var r=(crosshair.color<1||crosshair.color>4)&&e;control.slider.color_r.slider(r?"enable":"disable");control.slider.color_g.slider(r?"enable":"disable");control.slider.color_b.slider(r?"enable":"disable");control.spinner.color_r.spinner(r?"enable":"disable");control.spinner.color_g.spinner(r?"enable":"disable");control.spinner.color_b.spinner(r?"enable":"disable");$("#crosshair_color").css("opacity",r?1:.5);if(e)$("[for=crosshair_color_5]").css("opacity",1);else $("[for=crosshair_color_5]").css("opacity",.5)}function updateConfig(){control.config.val(getCrosshairConfig(crosshair));control.configConsole.val(getCrosshairConfig(crosshair,";"))}function updateBindsCrosshair(e,t){if(e)binds.crosshair[e]=binds.crosshair[e]?jQuery.extend(true,binds.crosshair[e],t):t;updateBinds()}function updateBinds(){var e=keyBinds=aliases="";var t=crosshairThicknessNext=crosshairThicknessPrev=crosshairSizeNext=crosshairSizePrev=crosshairGapNext=crosshairGapPrev=toggleCrosshairBind="";var n=[];var r=[];for(s in binds.crosshair){if(binds.crosshair[s].key&&binds.crosshair[s].name){t=getCrosshairConfig(binds.crosshair[s].crosshair,";","");crosshairThicknessNext=bound(round5(binds.crosshair[s].crosshair.thickness*10)/10+.5,0,30);crosshairThicknessPrev=bound(round5(binds.crosshair[s].crosshair.thickness*10)/10-.5,0,30);crosshairSizeNext=bound(Math.round(binds.crosshair[s].crosshair.size)+1,0,30);crosshairSizePrev=bound(Math.round(binds.crosshair[s].crosshair.size)-1,0,30);crosshairGapNext=bound(Math.round(binds.crosshair[s].crosshair.gap)+1,-25,25);crosshairGapPrev=bound(Math.round(binds.crosshair[s].crosshair.gap)-1,-25,25);aliases+='alias "'+binds.crosshair[s].name+'" "'+t;if(binds.size_inc)aliases+="bind "+binds.size_inc+" size_"+crosshairSizeNext+";";if(binds.size_dec)aliases+="bind "+binds.size_dec+" size_"+crosshairSizePrev+";";if(binds.thickness_inc)aliases+="bind "+binds.thickness_inc+" thick_"+(""+crosshairThicknessNext).replace(".","_")+";";if(binds.thickness_dec)aliases+="bind "+binds.thickness_dec+" thick_"+(""+crosshairThicknessPrev).replace(".","_")+";";if(binds.gap_inc)aliases+="bind "+binds.gap_inc+" gap_"+(""+crosshairGapNext).replace("-","_")+";";if(binds.gap_dec)aliases+="bind "+binds.gap_dec+" gap_"+(""+crosshairGapPrev).replace("-","_")+";";aliases+='" //'+BINDS_POST.CROSSHAIR+s+"\n";keyBinds+='bind "'+binds.crosshair[s].key+'" "'+binds.crosshair[s].name+"\" // Chrosshair '"+binds.crosshair[s].name+"'\n";n.push(s);r.push("'"+binds.crosshair[s].key+"': Crosshair '"+binds.crosshair[s].name+"'")}}var i="";if(binds.toggle&&n.length>0){var s=toggleCrosshairCurrent=toggleCrosshairNext=toggleCrosshairFirst=null;var o=binds.toggle;for(var u=0;u<n.length;u++){s=n[u];toggleCrosshairCurrent=binds.crosshair[s].name;if(u==0)toggleCrosshairFirst=toggleCrosshairCurrent;toggleCrosshairNext=n[u+1]!=undefined?binds.crosshair[n[u+1]].name:toggleCrosshairFirst;i+='alias "toggle_'+toggleCrosshairCurrent+'" "'+toggleCrosshairCurrent+";bind "+o+" toggle_"+toggleCrosshairNext+';"\n'}i+='bind "'+o+'" "toggle_'+toggleCrosshairFirst+'" // Toggle crosshairs\n';i+="\n";r.push("'"+o+"': Toggle "+n.length+" crosshairs")}var a="";if(binds.toggle_dot){a='alias "dot_on" "cl_crosshairdot 1; bind '+binds.toggle_dot+' dot_off;"\n';a+='alias "dot_off" "cl_crosshairdot 0; bind '+binds.toggle_dot+' dot_on;"\n';a+='bind "'+binds.toggle_dot+'" "dot_on" // Toggle crosshair dot\n';a+="\n";r.push("'"+binds.toggle_dot+"': Toggle crosshair dot")}var f="";if(binds.size_inc||binds.size_dec){var l=sizeIncPrev=null;var c=binds.size_inc;var h=binds.size_dec;for(var u=0;u<=30;u++){l=u<30?u+1:0;sizeIncPrev=u>0?u-1:30;f+='alias "size_'+u+'" "cl_crosshairsize '+u+";";if(c)f+="bind "+c+" size_"+l+";";if(h)f+="bind "+h+" size_"+sizeIncPrev+";";f+='"\n'}if(c){f+='bind "'+c+'" "size_0" // Increase crosshair size\n';r.push("'"+c+"': Increase crosshair size")}if(h){f+='bind "'+h+'" "size_30" // Decrease crosshair size\n';r.push("'"+h+"': Decrease crosshair size")}f+="\n"}var p="";if(binds.thickness_inc||binds.thickness_dec){var d=thicknessIncPrev=null;var v=binds.thickness_inc;var m=binds.thickness_dec;for(var u=0;u<=30;u+=.5){d=(""+(u<30?u+.5:0)).replace(".","_");thicknessIncPrev=(""+(u>0?u-.5:30)).replace(".","_");p+='alias "thick_'+(""+u).replace(".","_")+'" "cl_crosshairthickness '+u+";";if(v)p+="bind "+v+" thick_"+d+";";if(m)p+="bind "+m+" thick_"+thicknessIncPrev+";";p+='"\n'}if(v){p+='bind "'+v+'" "thick_0" // Increase crosshair thickness\n';r.push("'"+v+"': Increase crosshair thickness")}if(m){p+='bind "'+m+'" "thick_30" // Decrease crosshair thickness\n';r.push("'"+m+"': Decrease crosshair thickness")}p+="\n"}var g="";if(binds.gap_inc||binds.gap_dec){var y=gapIncPrev=null;var b=binds.gap_inc;var w=binds.gap_dec;for(var u=-25;u<=25;u++){y=(""+bound(u+1,-25,25)).replace("-","_");gapIncPrev=(""+bound(u-1,-25,25)).replace("-","_");g+='alias "gap_'+(""+u).replace("-","_")+'" "cl_crosshairgap '+u+";cl_fixedcrosshairgap "+u+";";if(b)g+="bind "+b+" gap_"+y+";";if(w)g+="bind "+w+" gap_"+gapIncPrev+";";g+='"\n'}if(b){g+='bind "'+b+'" "gap_0" // Increase crosshair gap\n';r.push("'"+b+"': Increase crosshair gap")}if(w){g+='bind "'+w+'" "gap_25" // Decrease crosshair gap\n';r.push("'"+w+"': Decrease crosshair gap")}g+="\n"}e+=aliases;e+="\n";e+=keyBinds;e+="\n";e+=i;e+=a;e+=f;e+=p;e+=g;e=jQuery.trim(e);if(e!=""){var E='\n\nalias "binds" "';for(var u in r){E+="echo "+r[u]+";"}E+='"';e+=E}binds_tab.autoexes.val(e);localStorage.setItem("autoexec",e)}function changeCrosshair(e){for(type in e){if(crosshair[type]!=undefined){crosshair[type]=parseFloat(e[type])}}crosshair.fgap=crosshair.gap;updateConfig();updateControl();updateCrosshair(canvas.crosshair,crosshair);animateCrosshair(true);if(crosshairTimeout)clearTimeout(crosshairTimeout);crosshairTimeout=setTimeout(function(){updateHash(crosshair)},2e3)}function changeConfig(){var e,t,n=control.config.val(),r={},i,s=0;for(type in CONFIG){e=new RegExp(CONFIG[type]+"\\s\\W?([\\-\\d.]+)\\W?");t=n.match(e);if(t!=null){i=getCrosshairValue(type,parseFloat(t[1]));if(t!=null&&crosshair[type]!=undefined&&crosshair[type]!=i){s++;r[type]=i}}}if(s>0)changeCrosshair(r);else updateConfig()}function changeBindAutoexec(){var e=/bind "(.+)" "([\w]+)"/g;var t=/alias "(.+)" "([\w\s;.\-]+)"\s?\/\/(.)(\w+)?/g;var n=binds_tab.autoexes.val();var r={crosshair:{},toggle:null,toggle_dot:null,gap_inc:null,gap_dec:null,size_inc:null,size_dec:null,thickness_inc:null,thickness_dec:null};var i=t.exec(n);var s=alias=type=null;while(i!=null){s=i[1];alias=i[2];type=i[3];id=i[4];switch(type){case BINDS_POST.CROSSHAIR:r.crosshair[id]={id:id,name:s,crosshairAlias:alias,crosshair:getCrosshairParsed(alias)};break}i=t.exec(n)}var i=e.exec(n);var o=s=type=null;while(i!=null){o=i[1];s=i[2];for(id in r.crosshair){if(s.match(new RegExp("^"+r.crosshair[id].name,"m"))){r.crosshair[id].key=o}}if(s.match(/^toggle_/m)){r.toggle=o}else if(s.match(/^dot_/m)){r.toggle_dot=o}else if(s.match(/^gap_25/m)){r.gap_inc=o}else if(s.match(/^gap_0/m)){r.gap_dec=o}else if(s.match(/^size_0/m)){r.size_inc=o}else if(s.match(/^size_30/m)){r.size_dec=o}else if(s.match(/^thick_0/m)){r.thickness_inc=o}else if(s.match(/^thick_30/m)){r.thickness_dec=o}i=e.exec(n)}binds_tab.crosshairs.find("tbody").empty();binds_tab.binds.find("tbody").empty();binds={crosshair:{}};var u=0;for(id in r.crosshair){if(r.crosshair[id].crosshair&&r.crosshair[id].key){binds_tab.crosshairs.addBind(r.crosshair[id].crosshair,r.crosshair[id].key,r.crosshair[id].name,id);u++}}for(type in r){if(type!="crosshair"&&r[type]){binds_tab.binds.addBind(type,r[type]);u++}}if(u==0)updateBinds()}function getHash(){var e=window.location.hash.substring(1);var t=e.split("/");var n={};var r;for(i in t){r=t[i].split(/[\:\=]/);n[r[0]]=r[1]}return n}function updateHash(e){var t=getHash();var n=$.extend(t,e);var r=[];for(key in n){if(key&&n[key]!=undefined&&key!="fgap"){r.push(key+"="+n[key])}}window.location.hash="#"+r.join("/")}function animateCrosshair(e){e=e||false;if(!isCrosshairDynamic(crosshair.style)){animate.step=0;return}if(e){if(animate.timout)animate.timout=clearTimeout(animate.timout);animate.timout=setTimeout(function(){animateCrosshair(false)},500);animate.step=10}else{animate.step-=1;if(animate.step<=0){clearInterval(animate.timout);animate.step=0}else{animate.timout=setTimeout(function(){animateCrosshair(false)},50)}}updateCrosshair(canvas.crosshair,crosshair)}var IMG_PATH=window.location.hostname=="localhost"?"img/":"https://s3.amazonaws.com/csgo-crosshair-generator/img/";var ALPHA_FACTOR=255;var THICKNESS_FACTOR=19;var LENGTH_FACTOR=19;var GAP_FACTOR=1;var GAP_PAD=3;var SHADOW_BLUR=0;var SHADOW_ALPHA=.9;var ANIMATE_GAP=20;var BINDS_POST={CROSSHAIR:"&",TOGGLE:"%",TOGGLE_DOT:"*",SIZE_INC:"(",SIZE_DEC:")",THICKNESS_INC:"#",THICKNESS_DEC:"@",GAP_INC:".",GAP_DEC:","};var COLOR={classic:{1:"#2EFA2E",2:"#FAFA2E",3:"#2E2EFA",4:"#2EFAFA"},def:{1:{cross:[0,"#4C462E",1,"#FFFCE9"],line:"#AAB79D",dot:"#A3A798"},2:{cross:[0,"#797F4F",1,"#EFF57B"],line:"#D1D48D",dot:"#D9DCA7"},3:{cross:[0,"#55847C",1,"#71E7D9"],line:"#8EC4B7",dot:"#A0AD91"},4:{cross:[0,"#7F8883",1,"#E0FFF0"],line:"#C4D4CA",dot:"#A5A99A"}}};var CONFIG={alpha:"cl_crosshairalpha",color:"cl_crosshaircolor",color_b:"cl_crosshaircolor_b",color_r:"cl_crosshaircolor_r",color_g:"cl_crosshaircolor_g",dot:"cl_crosshairdot",gap:"cl_crosshairgap",size:"cl_crosshairsize",style:"cl_crosshairstyle",usealpha:"cl_crosshairusealpha",thickness:"cl_crosshairthickness",fgap:"cl_fixedcrosshairgap"};var TEMPLATE={def:{alpha:200,color:5,color_b:50,color_r:50,color_g:250,dot:0,gap:0,size:5,style:2,usealpha:1,thickness:.5,fgap:0},dot:{alpha:255,color:5,color_b:0,color_r:0,color_g:255,dot:1,gap:0,size:0,style:2,usealpha:1,thickness:2,fgap:0},cross:{alpha:255,color:5,color_b:0,color_r:0,color_g:255,dot:1,gap:-5,size:5,style:2,usealpha:1,thickness:2,fgap:0},16:{alpha:200,color:5,color_b:50,color_r:50,color_g:255,dot:0,gap:14,size:6,style:3,usealpha:1,thickness:.5,fgap:0},hatton:{alpha:255,color:5,color_b:255,color_r:255,color_g:0,dot:1,gap:0,size:5,style:2,thickness:1,usealpha:1,fgap:0},nip_getright:{alpha:200,color:1,color_b:50,color_g:250,color_r:50,dot:0,gap:0,size:5,style:4,thickness:1.5,usealpha:1,fgap:0},nip_forest:{alpha:255,color:1,color_b:0,color_g:0,color_r:0,dot:0,gap:-1,size:6,style:4,thickness:1,usealpha:1,fgap:0},nip_friberg:{alpha:255,color:4,color_b:250,color_g:250,color_r:50,dot:0,gap:0,size:2,style:2,thickness:.5,usealpha:1,fgap:0},nip_xizt:{alpha:200,color:1,color_b:50,color_g:250,color_r:50,dot:0,gap:-1,size:5,style:2,thickness:1,usealpha:1,fgap:0},nip_fifflaren:{alpha:255,color:4,color_b:250,color_g:250,color_r:50,dot:0,gap:0,size:3,style:2,thickness:.5,usealpha:1,fgap:0}};var canvas={canvas:null,binds:{},stage:null,backgroundGroup:null,backgrounds:{},crosshair:{group:null,classic:{group:null,left:null,right:null,top:null,bottom:null,dot:null},def:{group:null,left:null,right:null,top:null,bottom:null,dot:null,lines:{left:null,right:null,top:null,bottom:null}}}};var crosshair=$.extend({},TEMPLATE.def);var control={spinner:{alpha:null,thickness:null,size:null,gap:null,color_r:null,color_g:null,color_b:null},slider:{alpha:null,thickness:null,size:null,gap:null,color_r:null,color_g:null,color_b:null},button:{usealpha:null,dot:null,style:null},buttonset:{color:null,style:null},colorPalette:null,config:null,configConsole:null};var center={x:0,y:0};var freeze=false;var background=0;var backgrounds=["de_dust2_6.jpg","de_dust2_7.jpg","de_inferno_1.jpg","de_inferno_3.jpg","de_nuke_3.jpg"];var animate={animating:false,step:0,timer:null,timout:null};var crosshairTimeout=null;var binds={crosshair:{},toggle:null,toggle_dot:null,size_inc:null,size_dec:null,thickness_inc:null,thickness_dec:null,gap_inc:null,gap_dec:null};var binds_tab={binds:null,autoexes:null};$(function(){canvas.canvas=$("#container");canvas.canvas.empty();canvas.stage=new Kinetic.Stage({container:canvas.canvas.attr("id"),width:canvas.canvas.width(),height:canvas.canvas.height()});canvas.stage.on("mousemove",function(e){if(!freeze){var t=canvas.stage.getUserPosition();if(canvas.backgrounds[background]&&canvas.backgrounds[background].getVisible()){canvas.backgrounds[background].setPosition((canvas.backgrounds[background].getWidth()-canvas.stage.getWidth())*(t.x/canvas.stage.getWidth())*-1,(canvas.backgrounds[background].getHeight()-canvas.stage.getHeight())*(t.y/canvas.stage.getHeight())*-1)}canvas.crosshair.group.setPosition(t.x,t.y);canvas.stage.draw();animateCrosshair(true)}});canvas.canvas.mouseout(function(){if(!freeze){canvas.crosshair.group.setPosition(center.x,center.y);if(canvas.backgrounds[background])canvas.backgrounds[background].centerBackground();canvas.stage.draw()}});canvas.canvas.click(function(){freeze=!freeze});center={x:canvas.stage.getWidth()/2,y:canvas.stage.getHeight()/2};var e=new Kinetic.Layer;canvas.stage.add(e);canvas.backgroundGroup=new Kinetic.Group({});e.add(canvas.backgroundGroup);canvas.backgroundGroup.moveToBottom();var t=$("#backgrounds");var n=$("<div />",{});t.append(n.attr("data-background",-1).css("background","white"));for(i in backgrounds){t.append(n.clone().attr("data-background",i).append($("<img  />",{src:IMG_PATH+"min_"+backgrounds[i],alt:""})))}t.children().click(function(e){loadBackground($(this).attr("data-background"))});canvas.crosshair=createCrosshair(e,crosshair,center);var r=function(e,t){e=e||"default";var n=0;if(e=="classic"&&!t)n=2;else if(e=="classic"&&t)n=3;else if(e=="default"&&!t)n=1;changeCrosshair({style:n})};control.buttonset.style=$("#crosshair_style_type").buttonset().change(function(e){r($(e.target).val(),control.button.style.is(":checked"))});control.button.style=$("#crosshair_style_dynamic").button().change(function(e){r(control.buttonset.style.find("input:checked").val(),$(this).is(":checked"))});createControlSlider("alpha",255);createControlSpinner("alpha",255);control.button.usealpha=$("#crosshair_usealpha").button().change(function(e){changeCrosshair({usealpha:$(this).is(":checked")?1:0})});createControlSlider("thickness",100,0,.5);createControlSpinner("thickness",100,0,.5);createControlSlider("size");createControlSpinner("size");createControlSlider("gap",100,-100);createControlSpinner("gap",100,-100);createControlSlider("color_r",255);createControlSpinner("color_r",255);createControlSlider("color_g",255);createControlSpinner("color_g",255);createControlSlider("color_b",255);createControlSpinner("color_b",255);control.colorPalette=$("#crosshair_color_palette").spectrum({color:rgbToHex(crosshair.color_r,crosshair.color_g,crosshair.color_b),change:function(e){var t=e.toRgb();changeCrosshair({color_r:t.r,color_g:t.g,color_b:t.b})},showInput:true,showPalette:true,palette:[["black","white","red"],["yellow","rgb(0, 255, 0);","blue"]]});control.buttonset.color=$("#crosshair_color_type").buttonset().change(function(e){changeCrosshair({color:$(e.target).val()})});control.button.dot=$("#crosshair_dot").button().change(function(e){changeCrosshair({dot:$(this).is(":checked")?1:0})});$(".crosshair_template").button();$("#crosshair_template_players").button({icons:{secondary:"ui-icon-triangle-1-s"}}).click(function(){var e=$(this).next().show().position({my:"left top",at:"left bottom",of:this});$(document).one("click",function(){e.hide()});return false}).next().hide().menu();$("*[data-template]").click(function(e){e.preventDefault();var t=$(this).attr("data-template");if(TEMPLATE[t]!=undefined)changeCrosshair(TEMPLATE[t])});control.config=$("#crosshair_config").change(changeConfig);control.configConsole=$("#crosshair_config_console").focus(function(){$(this).select()});$(window).resize(function(){canvas.canvas.children().hide();canvas.canvas.children().height(canvas.canvas.height()).width(canvas.canvas.width());canvas.stage.setSize(canvas.canvas.width(),canvas.canvas.height());canvas.stage.draw();center={x:canvas.stage.getWidth()/2,y:canvas.stage.getHeight()/2};canvas.canvas.children().show()});setTimeout(function(){$(window).resize()},100);$(window).keydown(function(e){if((e.metaKey||e.ctrlKey)&&e.keyCode==76||e.altKey&&e.keyCode==68||e.keyCode==117){updateHash(crosshair)}}).blur(function(e){updateHash(crosshair)});var s=$(".tabs");s.find("* >*[for]").click({tabs:s,content:$(".tab_content")},function(e){var t=$(e.target).attr("for");e.data.tabs.find("* >*").removeClass("selected");$(e.target).addClass("selected");e.data.content.children().removeClass("selected").filter("#"+t).addClass("selected")});s.find("#add_bind").click(function(){s.find("[for=binds_tab]").click();binds_tab.crosshairs.addBind()});binds_tab.tab=$("#binds_tab");binds_tab.tab.listenKey=function(){var e=function(e,t,n){if(n.parents("#bind_crosshairs").length>0){updateBindsCrosshair(e,{key:t})}else if(n.parents("#bind_binds").length>0){binds[e]=t;updateBinds()}};binds_tab.tab.find("tbody .bind input[name=bind_key]").unbind(".listenkey").bind("keydown.listenkey",function(e){if(e.keyCode==9)return true;e.preventDefault()}).bind("keyup.listenkey",{callback:e},function(e){if(e.keyCode==9)return true;e.preventDefault();$(e.target).val("").removeClass("error");var t=getBind(e.which);if(t){$(e.target).val(t)}else{}var n=$(e.target).parent().parent().attr("data-id");e.data.callback(n,$(e.target).val(),$(e.target));return false}).bind("blur.listenkey",{callback:e},function(e){var t=binds_tab.tab.find("tbody > .bind input[name=bind_key]");t.removeClass("error");t.filter(function(){return $(this).val()==""}).addClass("error");var n=$(e.target).val();var r=t.filter(function(){return $(this).val()==n});if(r.length>1)r.addClass("error")}).bind("mousedown.listenkey",{callback:e},function(e){if($(e.target).is(":focus")){e.preventDefault();var t=getBind(e.which);if(t){$(e.target).val(t);var n=$(e.target).parent().parent().attr("data-id");e.data.callback(n,t,$(e.target))}}}).bind("contextmenu.listenkey",function(e){e.preventDefault()});binds_tab.tab.find("tbody .bind .bind_key_keyboard").unbind(".listenkey").bind("click.listenkey",{callback:e},function(e){var t=$(this).parent().parent().find("input[name=bind_key]");o.showKeyboad(t,e.data.callback,$(this).position().top+$(this).outerHeight(),t.val());return false})};binds_tab.crosshairs=$("#bind_crosshairs");binds_tab.crosshairs.listenBindRow=function(){binds_tab.tab.listenKey();this.find("tbody .bind input[name=bind_name]").unbind("keyup").keyup(function(e){$(e.target).val($(e.target).val().replace(/\s/,"_").replace(/\W/,""));var t=$(e.target).val();if(t!=""){var n=$(e.target).parent().parent().attr("data-id");updateBindsCrosshair(n,{name:t})}}).blur(function(e){var t=$(e.target).val();if(t==""){var n=$(e.target).parent().parent().attr("data-id");t=n;updateBindsCrosshair(n,{name:t});$(e.target).val(t)}var r=binds_tab.crosshairs.find("tbody .bind input[name=bind_name]");r.removeClass("error");var i=r.filter(function(){return $(this).val()==t});if(i.length>1)i.addClass("error")});binds_tab.crosshairs.find("tbody .bind .remove_bind").click(function(e){var t=$(e.target).parent().parent().parent();var n=t.attr("data-id");t.hide();delete binds.crosshair[n];updateBindsCrosshair()})};binds_tab.crosshairs.listenBindRow();var o=$("#keyboard").hide();o.showKeyboad=function(e,t,n,r){o.find("button").removeClass("selected").removeClass("picked").removeAttr("disabled").unbind("click").one("click",{callback:t},function(t){var n=$(this).attr("data-key")||jQuery.trim($(this).text());e.val(n.toUpperCase()).blur();var r=e.parent().parent().attr("data-id");t.data.callback(r,n.toUpperCase(),e)});var i=function(e,t,n){var r=o.find('button[data-key="'+(/[\[\]\\\/\=]/i.test(e)?"\\"+e:e.toLowerCase())+'"]').addClass(t).prop("disabled",n);if(r.length==0)r=o.find("button:NOT([data-key])").filter(function(){return jQuery.trim($(this).text()).toLowerCase()==e.toLowerCase()}).addClass(t).prop("disabled",n?true:false)};var s=binds_tab.tab.find("tbody .bind input[name=bind_key]");if(s.length>0){s.each(function(e,t){i($(this).val(),"picked",true)})}if(r)i(r,"selected");this.css("left",$("#wrapper").innerWidth()-this.outerWidth()).css("top",n).show();$(document).one("click",function(){o.hide()})};binds_tab.crosshairs.addBind=function(e,t,n,r){e=e||crosshair;t=t||"";var i=this.find("tbody");var s=this.find("tfoot .bind").clone();var o=(parseFloat((""+this.find("tbody .bind:last-child").attr("data-id")).replace(/\D+/,""))||0)+1;if(!r)r="bind_"+o;if(!n)n="bind"+o;var u="crosshair_canvas_"+r;updateBindsCrosshair(r,{name:n,crosshair:jQuery.extend({},e),test:e,key:t});s.attr("data-id",r);var a=s.find("div.bind_crosshair_canvas").attr("id",u);var f=s.find("input").removeAttr("disabled");f.filter("[name=bind_crosshair]").val(getCrosshairConfig(e,";"));f.filter("[name=bind_name]").val(n);s.find(".add_bind").hide();s.find(".remove_bind").removeClass("hide");i.append(s);f.filter("[name=bind_key]").focus().val(t);binds_tab.crosshairs.listenBindRow();var l=new Kinetic.Stage({container:u,width:a.height(),height:a.width()});var c={x:0,y:0};var h=new Kinetic.Layer;l.add(h);var p=createCrosshair(h,e,c);updateCrosshair(p,e,true);var d=getCrosshairStyleType(e.style)=="classic"?p.classic.size:p.def.size;var v=l.getWidth()/2/d;h.setScale(v);h.setPosition(d*v,d*v);l.draw()};binds_tab.crosshairs.find("tfoot .bind .add_bind").click(function(){binds_tab.crosshairs.addBind()});binds_tab.binds=$("#bind_binds");binds_tab.binds_type=$("#bind_binds_type").menu().hide();binds_tab.binds.addBind=function(e,t){t=t||"";var n=binds_tab.binds.find("tbody");var r=binds_tab.binds.find("tfoot .bind").clone();r.find(".bind_type").attr("data-type",e).find(":first-child").text(getBindTypeTitle(e));r.attr("data-id",e);var i=r.find("input[name=bind_key]").val(t).removeAttr("disabled");if(t){binds[e]=t;updateBinds()}r.find(".remove_bind").removeClass("hide");n.append(r);binds_tab.binds.rebindRow();setTimeout(function(){i.focus()},50)};binds_tab.binds.rebindRow=function(){binds_tab.tab.listenKey();binds_tab.binds.find(".bind_type").unbind("click").click(function(e){var t=$(e.currentTarget);binds_tab.binds_type.find("a").show().filter(function(){return binds_tab.binds.find("tbody .bind .bind_type[data-type="+$(this).attr("data-type")+"]").length>0}).hide();binds_tab.binds_type.show().position({my:"left top",at:"left bottom",of:this}).find("a").unbind("click").click(function(e){e.preventDefault();if(t.parent().parent().parent().is("tfoot")){binds_tab.binds.addBind($(e.target).attr("data-type"))}else{var n=t.attr("data-type");var r=$(e.target).attr("data-type");var i=binds[n];t.attr("data-type",r);t.find(":first-child").text($(e.target).text());delete binds[n];if(i)binds[r]=i;updateBinds()}});$(document).one("click",function(){binds_tab.binds_type.hide()});return false});binds_tab.binds.find("tbody .bind .remove_bind").click(function(e){var t=$(e.target).parent().parent().parent();var n=t.attr("data-id");t.hide();delete binds[n];updateBinds()})};binds_tab.binds.rebindRow();binds_tab.autoexes=$("#binds_autoexes").change(changeBindAutoexec);$("#empty_autoexec").click(function(){binds_tab.autoexes.val("").change()});$(document).tooltip();loadBackground(background);changeCrosshair(getHash());if(localStorage.getItem("autoexec")!=null){binds_tab.autoexes.val(localStorage.getItem("autoexec")).change()}});